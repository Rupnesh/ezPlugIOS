(self.webpackChunkeZPlug=self.webpackChunkeZPlug||[]).push([[3070],{3070:(t,i,e)=>{"use strict";e.r(i),e.d(i,{SearchModalModule:()=>T});var n=e(8583),r=e(665),o=e(5298),s=e(7823),a=e(4762),c=e(5466),l=e(7716),u=e(7906),d=e(4471),g=e(5970);let h=(()=>{class t{transform(i,e){return e&&i?t.filter(i,e):i}static filter(t,i){const e=i.toLowerCase();function n(t,i){for(let r in t)if(null!==t[r]&&null!=t[r]){if("object"==typeof t[r]&&n(t[r],i))return!0;if(t[r].toString().toLowerCase().includes(e))return!0}return!1}return t.filter(function(t){return n(t,i)})}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275pipe=l.Yjl({name:"filter",type:t,pure:!1}),t.\u0275prov=l.Yz7({token:t,factory:t.\u0275fac}),t})(),p=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({}),t})();const m=["mainSearchbar"],f=function(t,i,e,n){return[t,i,e,n]};function L(t,i){if(1&t){const t=l.EpF();l.TgZ(0,"ion-item",20),l.NdJ("click",function(){const i=l.CHM(t).$implicit;return l.oxw(3).stationDetails(i)}),l.TgZ(1,"div",21),l.TgZ(2,"span",22),l._UZ(3,"div",23),l.TgZ(4,"ion-text",24),l._uU(5),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&t){const t=i.$implicit;l.xp6(3),l.Q6J("ngClass",l.l5B(2,f,t.isConnectedToIoTHub&&"Available"===t.status?"greenGradient":"",t.isConnectedToIoTHub&&"Offline"===t.status?"grayGradient":"",t.isConnectedToIoTHub&&"Occupied"===t.status?"redGradient":"",t.isConnectedToIoTHub?"":"grayGradient")),l.xp6(2),l.Oqu(null==t?null:t.stationName)}}function b(t,i){1&t&&(l.TgZ(0,"ion-item",25),l._UZ(1,"ion-spinner",26),l.qZA())}function x(t,i){if(1&t&&(l.TgZ(0,"ion-row"),l.YNc(1,L,6,7,"ion-item",18),l.YNc(2,b,2,0,"ion-item",19),l.qZA()),2&t){const t=l.oxw(2);l.xp6(1),l.Q6J("ngForOf",t.stationList),l.xp6(1),l.Q6J("ngIf",!t.stationListError)}}function Z(t,i){if(1&t){const t=l.EpF();l.TgZ(0,"ion-card",8),l.TgZ(1,"ion-card-content"),l.TgZ(2,"ion-row",9),l.NdJ("click",function(){const i=l.CHM(t),e=i.$implicit,n=i.index;return l.oxw().toggleGroup(e,n)}),l.TgZ(3,"ion-col",10),l.TgZ(4,"strong"),l.TgZ(5,"ion-text",11),l._uU(6),l.qZA(),l.qZA(),l.qZA(),l.TgZ(7,"ion-col",12),l.TgZ(8,"span"),l._UZ(9,"ion-icon",13),l.qZA(),l.qZA(),l.qZA(),l.TgZ(10,"ion-row",14),l.NdJ("click",function(){const i=l.CHM(t),e=i.$implicit,n=i.index;return l.oxw().toggleGroup(e,n)}),l.TgZ(11,"ion-col",10),l.TgZ(12,"ion-text",15),l._uU(13),l.qZA(),l.qZA(),l.TgZ(14,"ion-col",12),l.TgZ(15,"ion-text",16),l._uU(16),l.qZA(),l.qZA(),l.qZA(),l.YNc(17,x,3,2,"ion-row",17),l.qZA(),l.qZA()}if(2&t){const t=i.$implicit,e=l.oxw();l.xp6(6),l.Oqu(null==t?null:t.siteName),l.xp6(3),l.s9C("name",t.show?"chevron-down-circle":"chevron-forward-circle"),l.xp6(4),l.Oqu((null==t?null:t.address.slice(0,50))+"..."),l.xp6(3),l.hij("",null==t?null:t.distance.toFixed(0)," km"),l.xp6(1),l.Q6J("ngIf",e.isGroupShown(t))}}const S=[{path:"",component:(()=>{class t{constructor(t,i,e,n,r){this.router=t,this.dashboardService=i,this.loaderService=e,this.alertController=n,this.alertService=r,this.itemArray=[],this.siteList=[],this.term="",this.stationList=[],this.pricingDetails="",this.stationListError=!1,this.pageLimit=10}ngOnInit(){return(0,a.mG)(this,void 0,void 0,function*(){this.userLocation=yield this.dashboardService.getObject(c.E.USER_LOCATION),this.searchSiteData({SearchString:"",Lattitude:this.userLocation?this.userLocation.Lattitude:18.5204,Longitude:this.userLocation?this.userLocation.Longitude:73.8567,Limit:this.pageLimit}),setTimeout(()=>{this.searchBar.setFocus()},100)})}toggleGroup(t,i){this.stationList=[],this.stationListError=!1,this.dashboardService.setObject(t,c.E.SITE_DETAILS).then(i=>{this.siteList.map((i,e)=>{i.show=t.siteID===i.siteID}),this.dashboardService.getStationList(t.siteID).subscribe(t=>{!1===t.hasError?(this.stationList=t.stationViewModels,this.pricingDetails=t.pricingDetails,this.dashboardService.setItem(t.pricingDetails,c.E.PRICING_DETAILS),this.stationListError=!0):(this.alertService.presentToast(t.errorDescription),this.stationListError=!0)},t=>{this.stationListError=!0,this.alertService.presentToast(c.E.HTTP_RESPONSE_ERROR)})})}isGroupShown(t){return t.show}loadMoreSites(t){this.pageLimit=this.pageLimit+10,this.searchSiteData({SearchString:"",Lattitude:this.userLocation?this.userLocation.Lattitude:18.5204,Longitude:this.userLocation?this.userLocation.Longitude:73.8567,Limit:this.pageLimit}),setTimeout(()=>{t.target.complete()},500)}searchSiteData(t){this.searchLoader=!0,this.dashboardService.searchSiteData(t).subscribe(t=>{!1===t.hasError?(this.siteList=t.siteViewModels,this.searchLoader=!1):this.alertService.presentToast(t.errorDescription)},t=>{this.alertService.presentToast(c.E.HTTP_RESPONSE_ERROR)})}searchFn(t){return(0,a.mG)(this,void 0,void 0,function*(){t.preventDefault(),setTimeout(()=>{this.searchBar.setFocus()},100),null==t.target.value||""==t.target.value||null==t.target.value?(this.siteList=[],this.searchSiteData({SearchString:"",Lattitude:this.userLocation?this.userLocation.Lattitude:18.5204,Longitude:this.userLocation?this.userLocation.Longitude:73.8567,Limit:this.pageLimit})):(this.siteList=[],(2===t.target.value.length||4===t.target.value.length||6===t.target.value.length||8===t.target.value.length)&&this.searchSiteData({SearchString:t.target.value,Lattitude:this.userLocation?this.userLocation.Lattitude:18.5204,Longitude:this.userLocation?this.userLocation.Longitude:73.8567,Limit:this.pageLimit}))})}stationDetails(t){this.dashboardService.setObject(t,c.E.STATION_DETAILS).then(t=>{this.router.navigate(["app/station-details"])})}onClear(t){this.searchSiteData({SearchString:"",Lattitude:this.userLocation?this.userLocation.Lattitude:18.5204,Longitude:this.userLocation?this.userLocation.Longitude:73.8567,Limit:this.pageLimit})}closeModal(){}}return t.\u0275fac=function(i){return new(i||t)(l.Y36(o.F0),l.Y36(u.u),l.Y36(d.D),l.Y36(s.Br),l.Y36(g.c))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-search"]],viewQuery:function(t,i){if(1&t&&l.Gf(m,7),2&t){let t;l.iGM(t=l.CRH())&&(i.searchBar=t.first)}},decls:14,vars:4,consts:[["color","primary"],["slot","start"],["defaultHref","app/home"],["debounce","30000","showCancelButton","focus","mode","ios","placeholder","Search by Name or ID",1,"items-searchbar",3,"ionInput","ionCancel"],["mainSearchbar",""],["class","glass-card",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Loading more data..."],[1,"glass-card"],[2,"margin-bottom","5px",3,"click"],["size","9",2,"padding","0 !important"],["color","primary",1,"glass-card-site-name"],["size","3",2,"padding","0 !important","text-align","right"],["color","primary",2,"height","20px","width","20px",3,"name"],[3,"click"],["color","primary",1,"glass-card-site-address"],["color","primary",1,"glass-card-site-distance"],[4,"ngIf"],["class","inner-contents item-40px glass-card-inner","lines","none","style","margin-top: 16px;width: 100%;",3,"click",4,"ngFor","ngForOf"],["style","width: 100%;","class","inner-contents item-40px ","lines","none",4,"ngIf"],["lines","none",1,"inner-contents","item-40px","glass-card-inner",2,"margin-top","16px","width","100%",3,"click"],[2,"width","100%","display","flex","justify-content","space-between"],[2,"display","flex","align-items","center"],[2,"height","20px","width","20px","margin-right","10px","border-radius","50%",3,"ngClass"],["color","primary",1,"glass-card-station-name"],["lines","none",1,"inner-contents","item-40px",2,"width","100%"],["color","primary","name","bubbles",2,"text-align","center","display","block","margin","0 auto"]],template:function(t,i){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar",0),l.TgZ(2,"ion-buttons",1),l._UZ(3,"ion-back-button",2),l.qZA(),l.TgZ(4,"ion-title"),l._uU(5," Search "),l.qZA(),l.qZA(),l.qZA(),l.TgZ(6,"ion-content"),l.TgZ(7,"ion-searchbar",3,4),l.NdJ("ionInput",function(t){return i.searchFn(t)})("ionCancel",function(t){return i.onClear(t)}),l.qZA(),l.TgZ(9,"ion-list"),l.YNc(10,Z,18,5,"ion-card",5),l.ALo(11,"filter"),l.qZA(),l.TgZ(12,"ion-infinite-scroll",6),l.NdJ("ionInfinite",function(t){return i.loadMoreSites(t)}),l._UZ(13,"ion-infinite-scroll-content",7),l.qZA(),l.qZA()),2&t&&(l.xp6(10),l.Q6J("ngForOf",l.xi3(11,1,i.siteList,i.term)))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.wd,s.W2,s.VI,s.j9,s.q_,n.sg,s.ju,s.MB,s.PM,s.FN,s.Nd,s.wI,s.yW,s.gu,n.O5,s.Ie,n.mk,s.PQ],pipes:[h],styles:["ion-searchbar[_ngcontent-%COMP%]   .searchbar-input-container[_ngcontent-%COMP%]   .searchbar-input[_ngcontent-%COMP%]{box-shadow:none;border-bottom:1px solid #d4d5d6!important;background:red!important}.inner-contents[_ngcontent-%COMP%] > .item-native[_ngcontent-%COMP%] > .item-inner[_ngcontent-%COMP%]:last-child{border-bottom:0;--border-width:0 0 0 0!important;--border-style:none!important}ion-item.inner-contents[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:last-child{--border-style:none!important}.item-40px[_ngcontent-%COMP%]{--min-height:32px!important;--max-height:32px!important;height:32px!important;--inner-padding-end:0px!important}.avatar-circle[_ngcontent-%COMP%]{width:48px;height:48px;text-align:center;border-radius:50%;-webkit-border-radius:50%;-moz-border-radius:50%;display:table;margin:0 auto}.initials[_ngcontent-%COMP%]{font-size:18px;color:#fff;display:table-cell;vertical-align:middle}.greenGradient[_ngcontent-%COMP%]{background-color:#00b712;background-image:linear-gradient(315deg,#00b712,#5aff15 74%)}.redGradient[_ngcontent-%COMP%]{background-color:#fc9842;background-image:linear-gradient(315deg,#fc9842,#fe5f75 74%)}.grayGradient[_ngcontent-%COMP%]{background-color:#8b8b8b;background-image:linear-gradient(315deg,#8b8b8b,#ccc 74%)}.glass-card[_ngcontent-%COMP%], .glass-card-inner[_ngcontent-%COMP%]{border-radius:16px;box-shadow:20px 20px 60px #bebebe,-20px -20px 60px #fff}ion-item[_ngcontent-%COMP%]{--background:#0000!important}"]}),t})()}];let T=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({providers:[u.u],imports:[[n.ez,r.u5,s.Pc,o.Bz.forChild(S),p]]}),t})()}}]);